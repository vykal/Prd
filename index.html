<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiplayer 2D Hra</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }

        canvas {
            display: block;
            background: lightblue;
        }

        .controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .button {
            width: 60px;
            height: 60px;
            background: gray;
            color: white;
            font-size: 20px;
            font-weight: bold;
            text-align: center;
            line-height: 60px;
            border-radius: 10px;
            user-select: none;
            cursor: pointer;
        }

        .button:active {
            background: darkgray;
        }
    </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div class="controls">
    <div class="button" id="left">◀</div>
    <div class="button" id="jump">⤒</div>
    <div class="button" id="right">▶</div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getDatabase, ref, set, onValue, remove } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

    // Firebase konfigurácia
    const firebaseConfig = {
        apiKey: "AIzaSyACWLI7L0zhZk7RFQyEXlOyQjtMPF-MgDw",
        authDomain: "hrav-1a742.firebaseapp.com",
        databaseURL: "https://hrav-1a742-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "hrav-1a742",
        storageBucket: "hrav-1a742.firebasestorage.app",
        messagingSenderId: "1093772001619",
        appId: "1:1093772001619:web:97d8e6dd9d5cd28da761a6",
        measurementId: "G-GFVZ6ZD5RE"
    };

    // Inicializácia Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Generovanie unikátneho ID pre hráča
    const playerId = `player_${Math.random().toString(36).substring(2, 9)}`;
    const colors = ["red", "blue", "green", "orange", "purple"];
    const playerColor = colors[Math.floor(Math.random() * colors.length)];

    const player = {
        id: playerId,
        x: Math.random() * (canvas.width - 50),
        y: canvas.height - 150,
        width: 50,
        height: 50,
        color: playerColor,
        dx: 0,
        dy: 0,
        isJumping: false,
        grounded: true // Nový stav pre kontrolu, či je hráč na zemi
    };

    const players = {};

    // Pohyb hráča
    function movePlayer() {
        player.x += player.dx;

        // Gravitácia
        if (!player.grounded) {
            player.dy += 0.8; // Akcelerácia gravitácie
            player.y += player.dy;
        }

        // Kontrola, či hráč dopadol na zem
        if (player.y + player.height >= canvas.height) {
            player.y = canvas.height - player.height; // Zarovnanie na zem
            player.dy = 0;
            player.grounded = true;
            player.isJumping = false;
        }

        // Obmedziť pohyb do strán
        if (player.x < 0) player.x = 0;
        if (player.x + player.width > canvas.width) player.x = canvas.width - player.width;
    }

    // Kreslenie všetkých hráčov
    function drawPlayers() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        Object.values(players).forEach(p => {
            ctx.fillStyle = p.color;
            ctx.fillRect(p.x, p.y, p.width, p.height);
        });
    }

    // Ovládanie dotykom
    const leftButton = document.getElementById('left');
    const rightButton = document.getElementById('right');
    const jumpButton = document.getElementById('jump');

    leftButton.addEventListener('mousedown', () => player.dx = -5);
    rightButton.addEventListener('mousedown', () => player.dx = 5);
    jumpButton.addEventListener('mousedown', () => {
        if (player.grounded) {
            player.dy = -15; // Rýchlosť skoku
            player.grounded = false;
            player.isJumping = true;
        }
    });

    leftButton.addEventListener('mouseup', () => player.dx = 0);
    rightButton.addEventListener('mouseup', () => player.dx = 0);

    leftButton.addEventListener('touchstart', () => player.dx = -5);
    rightButton.addEventListener('touchstart', () => player.dx = 5);
    jumpButton.addEventListener('touchstart', () => {
        if (player.grounded) {
            player.dy = -15;
            player.grounded = false;
            player.isJumping = true;
        }
    });

    leftButton.addEventListener('touchend', () => player.dx = 0);
    rightButton.addEventListener('touchend', () => player.dx = 0);

    // Posielanie dát do Firebase
    function sendDataToFirebase() {
        const playerRef = ref(db, `players/${player.id}`);
        set(playerRef, player);
    }

    // Odstránenie hráča z Firebase pri odpojení
    window.addEventListener('beforeunload', () => {
        const playerRef = ref(db, `players/${player.id}`);
        remove(playerRef);
    });

    // Načítanie hráčov z Firebase
    const playersRef = ref(db, 'players');
    onValue(playersRef, (snapshot) => {
        const data = snapshot.val() || {};
        Object.keys(data).forEach(id => {
            players[id] = data[id];
        });
        drawPlayers();
    });

    // Aktualizácia hry
    function update() {
        movePlayer();
        sendDataToFirebase();
        requestAnimationFrame(update);
    }

    update();
</script>
</body>
</html>




<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Video Meeting</title>
  <style>
    #videos {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    video {
      border: 1px solid #ccc;
      border-radius: 5px;
      width: 200px;
      height: 150px;
      object-fit: cover;
    }
    #clearDatabaseButton {
      margin: 20px;
      padding: 10px 20px;
      background-color: red;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #clearDatabaseButton:hover {
      background-color: darkred;
    }
  </style>
</head>
<body>
  <h1>Video Meeting</h1>
  <button id="clearDatabaseButton">Odstrániť všetkých používateľov</button>
  <div id="videos"></div>

  <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-app.js";
import { getDatabase, ref, set, onValue, remove, push } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-database.js";

// Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyB-sXXU2-dWigTrpYp1hnWbDjqqJ2gr0Yw",
  authDomain: "videjo-d0996.firebaseapp.com",
  databaseURL: "https://videjo-d0996-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "videjo-d0996",
  storageBucket: "videjo-d0996.firebasestorage.app",
  messagingSenderId: "175126755237",
  appId: "1:175126755237:web:8cf31d7a4d08f9fb2bda4c",
  measurementId: "G-6Q2BJX1FE5"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// Unique user ID
const userId = Math.random().toString(36).substring(2, 15);

// WebRTC configuration
const config = {
  iceServers: [{ urls: "stun:stun.l.google.com:19302" }]
};

const peers = {}; // Store peer connections
const pendingCandidates = {}; // Store ICE candidates temporarily
const addedVideoElements = new Set(); // Track added video elements
const localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });

// Add video stream to the DOM
const addVideoStream = (stream, id) => {
  if (addedVideoElements.has(id)) return; // Prevent duplicate video elements

  const video = document.createElement("video");
  video.srcObject = stream;
  video.autoplay = true;
  video.muted = id === userId; // Mute local stream
  video.dataset.userId = id;
  document.getElementById("videos").appendChild(video);

  // Mark video as added
  addedVideoElements.add(id);
};

// Add local stream to page
addVideoStream(localStream, userId);

// Notify Firebase about the new user
set(ref(db, `users/${userId}`), { userId });

// Handle user disconnection
window.addEventListener("beforeunload", () => {
  remove(ref(db, `users/${userId}`));
  addedVideoElements.delete(userId); // Clean up added video elements
});

// SDP cleaner function
const cleanSDP = (sdp) => {
  return sdp.replace(/a=extmap:.+?\n/g, ''); // Remove incompatible extmap lines
};

// Listen for new users
onValue(ref(db, "users"), (snapshot) => {
  const users = snapshot.val();
  for (const id in users) {
    if (id !== userId && !peers[id]) {
      connectToNewUser(id);
    }
  }
});

// WebRTC signaling logic
const connectToNewUser = (id) => {
  const peerConnection = new RTCPeerConnection(config);

  // Add local stream tracks
  localStream.getTracks().forEach((track) => {
    peerConnection.addTrack(track, localStream);
  });

  // Send ICE candidates to Firebase
  peerConnection.onicecandidate = (event) => {
    if (event.candidate) {
      push(ref(db, `signals/${id}`), {
        from: userId,
        candidate: event.candidate.toJSON(),
      });
    }
  };

  // Handle incoming streams
  peerConnection.ontrack = (event) => {
    const [remoteStream] = event.streams;
    addVideoStream(remoteStream, id);
  };

  // Create offer and send it to Firebase
  peerConnection.createOffer()
    .then((offer) => {
      peerConnection.setLocalDescription(offer);
      push(ref(db, `signals/${id}`), {
        from: userId,
        offer,
      });
    });

  peers[id] = peerConnection;
};

// Signal handling through Firebase
onValue(ref(db, `signals/${userId}`), (snapshot) => {
  const signals = snapshot.val();
  if (!signals) return;

  for (const key in signals) {
    const signal = signals[key];
    const { from, offer, answer, candidate } = signal;

    if (from === userId) continue;

    let peerConnection = peers[from];
    if (!peerConnection) {
      peerConnection = new RTCPeerConnection(config);
      localStream.getTracks().forEach((track) => {
        peerConnection.addTrack(track, localStream);
      });

      peerConnection.onicecandidate = (event) => {
        if (event.candidate) {
          push(ref(db, `signals/${from}`), {
            from: userId,
            candidate: event.candidate.toJSON(),
          });
        }
      };

      peerConnection.ontrack = (event) => {
        const [remoteStream] = event.streams;
        addVideoStream(remoteStream, from);
      };

      peers[from] = peerConnection;
    }

    // Handle offer
    if (offer && peerConnection.signalingState === "stable") {
      const cleanOffer = cleanSDP(offer.sdp); // Clean SDP
      peerConnection
        .setRemoteDescription(new RTCSessionDescription({ type: "offer", sdp: cleanOffer }))
        .then(() => {
          peerConnection.createAnswer().then((answer) => {
            peerConnection.setLocalDescription(answer);
            push(ref(db, `signals/${from}`), {
              from: userId,
              answer,
            });
          });

          // Add pending ICE candidates
          if (pendingCandidates[from]) {
            pendingCandidates[from].forEach((pending) => {
              peerConnection.addIceCandidate(new RTCIceCandidate(pending));
            });
            delete pendingCandidates[from];
          }
        })
        .catch((error) => console.error("Error handling offer:", error));
    }

    // Handle answer
    if (answer && peerConnection.signalingState === "have-local-offer") {
      const cleanAnswer = cleanSDP(answer.sdp); // Clean SDP
      peerConnection
        .setRemoteDescription(new RTCSessionDescription({ type: "answer", sdp: cleanAnswer }))
        .catch((error) => console.error("Error handling answer:", error));
    }

    // Handle ICE candidates
    if (candidate) {
      if (peerConnection.remoteDescription && peerConnection.remoteDescription.type) {
        peerConnection
          .addIceCandidate(new RTCIceCandidate(candidate))
          .catch((error) => console.error("Error adding ICE candidate:", error));
      } else {
        if (!pendingCandidates[from]) {
          pendingCandidates[from] = [];
        }
        pendingCandidates[from].push(candidate);
      }
    }
  }
});

// Clear all Firebase data
document.getElementById("clearDatabaseButton").addEventListener("click", () => {
  if (confirm("Naozaj chcete odstrániť všetkých používateľov a signály z databázy?")) {
    remove(ref(db)).then(() => {
      alert("Všetci používatelia a signály boli odstránené.");
    }).catch((error) => {
      console.error("Chyba pri odstraňovaní databázy:", error);
    });
  }
});
  </script>
</body>
</html>

Skús sa z týchto kódov čo najviac naučiť ako fungujú.
Vytvor s pomocou týchto kodou jeden kod pre stránku ktorá bude fungovať takto:
Každý kto si stránku otvorí bude môcť ovládať svojho hrača ale namiesto stvorčeku to bude jeho kamerove okno a všetci hráči sa budú vidieť ako sa pohybujú po hracej ploche so svojimi kamerovimy oknami
Využi obidve reallife database jednu pre uchovanie lokality kamerových okien a druhú na prenos videozáznamu čerpaj z obidvoch kodov

Vytvor prosím úplne funkčnú aplikáciu nech sa dá rovno používať. Nech je to niečo ako takýinteraktivny video meeting


Tu sú informácie ku databazami
// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyB-sXXU2-dWigTrpYp1hnWbDjqqJ2gr0Yw",
  authDomain: "videjo-d0996.firebaseapp.com",
  databaseURL: "https://videjo-d0996-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "videjo-d0996",
  storageBucket: "videjo-d0996.firebasestorage.app",
  messagingSenderId: "175126755237",
  appId: "1:175126755237:web:8cf31d7a4d08f9fb2bda4c",
  measurementId: "G-6Q2BJX1FE5"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);




// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyACWLI7L0zhZk7RFQyEXlOyQjtMPF-MgDw",
  authDomain: "hrav-1a742.firebaseapp.com",
  databaseURL: "https://hrav-1a742-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "hrav-1a742",
  storageBucket: "hrav-1a742.firebasestorage.app",
  messagingSenderId: "1093772001619",
  appId: "1:1093772001619:web:97d8e6dd9d5cd28da761a6",
  measurementId: "G-GFVZ6ZD5RE"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);

Skús js toho kódu ktorý vytvoriš rozkuzkovat a také bloky
